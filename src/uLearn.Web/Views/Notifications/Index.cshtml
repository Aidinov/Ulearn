@model uLearn.Web.Controllers.NotificationSettingsViewModel

@{
	ViewBag.Title = "Настройки уведомлений";
}

<div class="container">
	<h2>Настройки уведомлений</h2>

	<table class="notification-settings__table">
		<thead>
		<tr>
			<th></th>
			@foreach (var transport in Model.Transports)
			{
				<th>
					@if (transport is MailNotificationTransport)
					{
						<text>Эл. почта @(((MailNotificationTransport) transport).Email) </text>
					}
					else if (transport is TelegramNotificationTransport)
					{
						<text>Телеграм</text>
					}
				</th>
			}
			<th>
				Добавить: <br/>
				<a href="#" class="internal-page-link" data-toggle="modal" data-target="#notification-settings__add-mail-transport__modal">почту</a> <br/>
				<a href="#" class="internal-page-link">телеграм</a>
			</th>
		</tr>
		</thead>
		<tbody>
		@foreach (var notificationType in Model.NotificationTypes)
		{
			<tr>
				<td>
					@notificationType.GetGroupName()
				</td>
				@foreach (var transport in Model.Transports)
				{
					<td>
						@{
							var settings = Model.TransportsSettings[Tuple.Create(transport.Id, notificationType)];
							var frequency = settings == null ? NotificationSendingFrequency.Disabled : settings.Frequency;

							<div class="btn-group">
								@foreach (var f in (NotificationSendingFrequency[])Enum.GetValues(typeof(NotificationSendingFrequency)))
								{
									<button class="btn btn-default btn-xs @(f == frequency ? "active" : "")">@f</button>
								}
							</div>
						}
					</td>
				}
				<td></td>
			</tr>
		}
		</tbody>
	</table>
</div>

<div class="notification-settings__add-mail-transport__modal modal fade" id="notification-settings__add-mail-transport__modal">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
				<h4 class="modal-title">Добавить почту</h4>
			</div>
			<div class="modal-body">
				@using (Html.BeginForm("AddMailTransport", "Notifications", new { courseId = Model.CourseId }))
				{
					<div class="form-group">
						<input type="text" name="email" value="" placeholder="Введите эл. почту" class="form-control">
					</div>
					<div class="form-group">
						<button class="btn btn-success copy-group-button">Добавить</button>
					</div>
				}
			</div>
		</div>
	</div>
</div>