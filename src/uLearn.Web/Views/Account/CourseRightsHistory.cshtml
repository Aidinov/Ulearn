@using uLearn.Web.Controllers
@model UserCourseHistoryModel

@{
	ViewBag.Title = "User Course Stats";
}
<div class="container">
	<h2 class="space-after">
		@Html.ActionLink(Model.User.VisibleName, "Profile", "Account", new { userId = Model.User.Id }, new { title = Model.User.UserName })
		— "@Model.Course.Title". Роли и права.
	</h2>

	<table class="table">
		<tr>
			<th style="text-align: center !important">Роль или права</th>
			<th style="text-align: center !important">Выданы или отозваны</th>
			<th style="text-align: center !important">Выданы пользователем</th>
			<th style="text-align: center !important">Дата (UTC)</th>
			<th style="text-align: center !important">Комментарий</th>
		</tr>
		@if (Model.UserGrantsHistory.ContainsKey(Model.Course.Id))
		{
			foreach (var grant in Model.UserGrantsHistory[Model.Course.Id])
			{
				var timestamp = grant.GrantTimeUtc == DateTime.MinValue ? "Неизвестно" : grant.GrantTimeUtc.ToString();
				var grantedBy = string.IsNullOrEmpty(grant.GrantedBy) ? "Неизвестно" : grant.GrantedBy;
				var comment = string.IsNullOrEmpty(grant.Comment) ? "Без комментария" : grant.Comment;

				var bgColor = grant.GrantType == typeof(RoleGrantModel) ? "#fffcdd" : "white";
				var enabled = grant.IsEnabled ? "Выданы" : "Отозваны";
				<tr style="text-align: center" bgcolor=@bgColor>
					<td style="text-align: left;"> @grant.Grant</td>
					<td style="text-align: center;">@enabled</td>
					<td style="text-align: left;">@grantedBy </td>
					<td class="grantTime" style="text-align: center;">@timestamp</td>
					<td style="white-space: pre-wrap; text-align: left;">@comment</td>
				</tr>
			}
		}

	</table>
	
	<script>
	$(document).ready(function($) {
               
            
                 
		$(".grantTime").innerText = "";
		})
	</script>

</div>