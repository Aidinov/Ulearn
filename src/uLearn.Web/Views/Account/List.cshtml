@using Database.Models
@using Ulearn.Common.Extensions
@using FormMethod = System.Web.Mvc.FormMethod
@model Database.UserSearchQueryModel


@{
	ViewBag.Title = "Пользователи";
}

<div class="container">
	<h1>Пользователи</h1>

    <p>
        <a class="label label-danger" href="@Url.Action("List", new { role = LmsRoles.SysAdmin })">@LmsRoles.SysAdmin.GetDisplayName()</a> может всё.
    </p>
    <p>
        <a class="label label-warning" href="@Url.Action("List", new { courseRole = CourseRole.CourseAdmin })">@CourseRole.CourseAdmin.GetDisplayName()</a> может видеть служебную информацию и управлять ролями других пользователей в рамках курса.
    </p>
    <p>
        <a class="label label-info" href="@Url.Action("List", new { courseRole = CourseRole.Instructor })">@CourseRole.Instructor.GetDisplayName()</a> может видеть статистику по успеваемости, проверять работы, отвечать на комментарии.
    </p>
    <p>
        <a class="label label-success" href="@Url.Action("List", new { courseRole = CourseRole.Tester })">@CourseRole.Tester.GetDisplayName()</a> может видеть ещё не опубликованные материалы.
    </p>
    <p>
        <a class="label label-default" href="@Url.Action("List")">Обычный пользователь</a> может видеть только опубликованные материалы.
    </p>

	<p>
		@using (Html.BeginForm("List", "Account", FormMethod.Get, new { @class = "form-inline" }))
		{
			<div class="input-group">
				<input class="form-control" type="text" name="namePrefix" value="@Model.NamePrefix"/>
				<span class="input-group-btn">
					<button class="btn btn-primary button" type="submit">Фильтровать по имени</button>
				</span>
			</div>
		}
	</p>
	
	@Popup()

	@Html.Action("ListPartial", Model)

</div>

@helper Popup()
{
	<div class="popup-fade">
		<div class="popup">
			@SubmitCommentButton()
			<a class="popup-close" href="#">Отмена</a>
			<textarea class="grantCommentField" rows="5" cols="30" ></textarea>
		</div>
	</div>
	<style>
    .popup-fade {
        display: none;
    }
    .popup-fade:before {
        content: '';
        background: #000;
        position: fixed; 
        left: 0;
        top: 0;
        width: 100%; 
        height: 100%;
        opacity: 0.7;
        z-index: 9999;
    }
    .popup {
        position: fixed;
        top: 20%;
        left: 50%;
        padding: 20px;
        width: 360px;
        margin-left: -200px;    
        background: #fff;
        border: 1px solid orange;
        border-radius: 4px; 
        z-index: 99999;
        opacity: 1;    
    }
    .popup-close {
        position: absolute;
        top: 10px;
        right: 10px;
    }
    .grantCommentField{
    resize: none
    }
    </style>
	//<script src="https://yandex.st/jquery/2.1.1/jquery.min.js"></script>
	<script>
    $(document).ready(function($) {
           
        
        $('.popup-close').click(function() {
            $(this).parents('.popup-fade').fadeOut();
            return false;
        });     
        
    
        
    });
    </script>
}
@helper SubmitCommentButton()
{
	<a class="popup-submit" href="#" onclick="SubmitComment(this)">Сохранить</a>
}